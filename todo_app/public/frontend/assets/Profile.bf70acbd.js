var y=(j,w,i)=>new Promise((m,s)=>{var a=n=>{try{v(i.next(n))}catch(x){s(x)}},p=n=>{try{v(i.throw(n))}catch(x){s(x)}},v=n=>n.done?m(n.value):Promise.resolve(n.value).then(a,p);v((i=i.apply(j,w)).next())});import{l as f,G as S,H as g,a as A,b,d as t,t as o,e as d,w as k,u,L as D,C as U,K as T,s as L,o as h,i as _,B as C}from"./index.284a7753.js";import{I as V}from"./Input.5e03f66f.js";import{C as z}from"./circle-check-big.90b12c59.js";const I={class:"p-8"},N={key:0,class:"text-center py-12"},$={key:1,class:"max-w-4xl"},F={class:"bg-white rounded-lg shadow-sm p-8 mb-6"},J={class:"flex items-start gap-6"},G={class:"flex-shrink-0"},K={class:"h-24 w-24 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center text-white text-3xl font-bold shadow-lg"},O={class:"flex-1"},R={class:"flex items-center justify-between"},q={class:"text-2xl font-bold text-gray-900"},Q={class:"text-gray-600 mt-1"},W={class:"grid grid-cols-2 gap-4 mt-6"},X={class:"text-sm font-medium text-gray-900 mt-1"},Y={class:"text-sm font-medium text-gray-900 mt-1"},Z={class:"text-sm font-medium text-gray-900 mt-1"},tt={class:"text-sm font-medium text-gray-900 mt-1"},et={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6"},st={class:"bg-white rounded-lg shadow-sm p-6"},lt={class:"flex items-center justify-between"},ot={class:"text-3xl font-bold text-gray-900 mt-1"},at={class:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center"},nt={class:"bg-white rounded-lg shadow-sm p-6"},rt={class:"flex items-center justify-between"},it={class:"text-3xl font-bold text-gray-900 mt-1"},dt={class:"w-12 h-12 rounded-full bg-green-100 flex items-center justify-center"},ut={class:"bg-white rounded-lg shadow-sm p-6"},mt={class:"flex items-center justify-between"},ct={class:"text-3xl font-bold text-gray-900 mt-1"},pt={class:"w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center"},ft={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},gt={class:"bg-white rounded-lg p-6 max-w-md w-full"},vt={class:"space-y-4"},xt={class:"mt-6 flex gap-3 justify-end"},kt={__name:"Profile",setup(j){const w=f(!0),i=f(!1),m=f(!1),s=f({full_name:"",email:"",username:"",user_type:"",creation:"",last_active:""}),a=f({full_name:"",email:""}),p=f({totalTasks:0,completedTasks:0,totalAppointments:0});S(()=>y(this,null,function*(){try{const l=yield g("frappe.auth.get_logged_user"),e=yield g("frappe.client.get",{doctype:"User",name:l});s.value={full_name:e.full_name||e.first_name||"User",email:e.email,username:e.username,user_type:e.user_type,creation:e.creation,last_active:e.last_active||new Date().toISOString()},a.value={full_name:s.value.full_name,email:s.value.email},yield v()}catch(l){console.error("Error fetching profile:",l)}finally{w.value=!1}}));function v(){return y(this,null,function*(){try{const l=yield g("frappe.client.get_count",{doctype:"Todo Item"}),e=yield g("frappe.client.get_count",{doctype:"Todo Item",filters:{status:"Completed"}}),r=yield g("frappe.client.get_count",{doctype:"Appointment"});p.value={totalTasks:l,completedTasks:e,totalAppointments:r}}catch(l){console.error("Error fetching stats:",l)}})}const n=A(()=>s.value.full_name.charAt(0).toUpperCase());function x(){m.value=!0}function B(){return y(this,null,function*(){i.value=!0;try{yield g("frappe.client.set_value",{doctype:"User",name:s.value.email,fieldname:"full_name",value:a.value.full_name}),s.value.full_name=a.value.full_name,m.value=!1,alert("Profile updated successfully!")}catch(l){console.error("Error updating profile:",l),alert("Failed to update profile")}finally{i.value=!1}})}function E(){window.open("/app/user/"+s.value.email,"_blank")}function H(){return y(this,null,function*(){confirm("Are you sure you want to logout?")&&(window.location.href="/api/method/logout")})}function M(l){return l?new Date(l).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"N/A"}function P(l){if(!l)return"Just now";const e=new Date(l),r=new Date,c=Math.floor((r-e)/1e3);return c<60?"Just now":c<3600?`${Math.floor(c/60)}m ago`:c<86400?`${Math.floor(c/3600)}h ago`:c<604800?`${Math.floor(c/86400)}d ago`:M(l)}return(l,e)=>(h(),b("div",I,[e[26]||(e[26]=t("h1",{class:"text-3xl font-bold text-gray-900 mb-8"},"Profile",-1)),w.value?(h(),b("div",N,[...e[4]||(e[4]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),t("p",{class:"mt-2 text-gray-600"},"Loading profile...",-1)])])):(h(),b("div",$,[t("div",F,[t("div",J,[t("div",G,[t("div",K,o(n.value),1)]),t("div",O,[t("div",R,[t("div",null,[t("h2",q,o(s.value.full_name),1),t("p",Q,o(s.value.email),1)]),d(u(C),{onClick:e[0]||(e[0]=r=>m.value=!0),variant:"outline"},{default:k(()=>[...e[5]||(e[5]=[_(" Edit Profile ",-1)])]),_:1})]),t("div",W,[t("div",null,[e[6]||(e[6]=t("p",{class:"text-sm text-gray-500"},"User Type",-1)),t("p",X,o(s.value.user_type||"System User"),1)]),t("div",null,[e[7]||(e[7]=t("p",{class:"text-sm text-gray-500"},"Username",-1)),t("p",Y,o(s.value.username||s.value.email),1)]),t("div",null,[e[8]||(e[8]=t("p",{class:"text-sm text-gray-500"},"Member Since",-1)),t("p",Z,o(M(s.value.creation)),1)]),t("div",null,[e[9]||(e[9]=t("p",{class:"text-sm text-gray-500"},"Last Active",-1)),t("p",tt,o(P(s.value.last_active)),1)])])])])]),t("div",et,[t("div",st,[t("div",lt,[t("div",null,[e[10]||(e[10]=t("p",{class:"text-sm text-gray-600"},"Total Tasks",-1)),t("p",ot,o(p.value.totalTasks),1)]),t("div",at,[d(u(D),{class:"w-6 h-6 text-blue-600"})])])]),t("div",nt,[t("div",rt,[t("div",null,[e[11]||(e[11]=t("p",{class:"text-sm text-gray-600"},"Completed",-1)),t("p",it,o(p.value.completedTasks),1)]),t("div",dt,[d(u(z),{class:"w-6 h-6 text-green-600"})])])]),t("div",ut,[t("div",mt,[t("div",null,[e[12]||(e[12]=t("p",{class:"text-sm text-gray-600"},"Appointments",-1)),t("p",ct,o(p.value.totalAppointments),1)]),t("div",pt,[d(u(U),{class:"w-6 h-6 text-purple-600"})])])])]),t("div",{class:"grid grid-cols-1 md:grid-cols-2 gap-6"},[t("div",{class:"bg-white rounded-lg shadow-sm p-6"},[e[16]||(e[16]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Settings",-1)),t("div",{class:"space-y-3"},[t("button",{onClick:E,class:"w-full py-3 px-4 bg-gray-50 rounded-lg text-left hover:bg-gray-100 transition-colors flex items-center gap-3"},[...e[13]||(e[13]=[t("svg",{class:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})],-1),t("span",{class:"font-medium"},"Change Password",-1)])]),t("button",{onClick:x,class:"w-full py-3 px-4 bg-gray-50 rounded-lg text-left hover:bg-gray-100 transition-colors flex items-center gap-3"},[...e[14]||(e[14]=[t("svg",{class:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),t("span",{class:"font-medium"},"Edit Profile",-1)])]),e[15]||(e[15]=T('<button class="w-full py-3 px-4 bg-gray-50 rounded-lg text-left hover:bg-gray-100 transition-colors flex items-center gap-3"><svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg><span class="font-medium">Preferences</span></button>',1))])]),t("div",{class:"bg-white rounded-lg shadow-sm p-6"},[e[19]||(e[19]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Help & Support",-1)),t("div",{class:"space-y-3"},[e[18]||(e[18]=T('<button class="w-full py-3 px-4 bg-gray-50 rounded-lg text-left hover:bg-gray-100 transition-colors flex items-center gap-3"><svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span class="font-medium">Help Center</span></button><button class="w-full py-3 px-4 bg-gray-50 rounded-lg text-left hover:bg-gray-100 transition-colors flex items-center gap-3"><svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg><span class="font-medium">Contact Support</span></button>',2)),t("button",{onClick:H,class:"w-full py-3 px-4 bg-red-50 text-red-600 rounded-lg text-left hover:bg-red-100 transition-colors flex items-center gap-3"},[...e[17]||(e[17]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})],-1),t("span",{class:"font-medium"},"Logout",-1)])])])])])])),m.value?(h(),b("div",ft,[t("div",gt,[e[25]||(e[25]=t("h2",{class:"text-2xl font-bold text-gray-900 mb-6"},"Edit Profile",-1)),t("div",vt,[t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Full Name",-1)),d(u(V),{modelValue:a.value.full_name,"onUpdate:modelValue":e[1]||(e[1]=r=>a.value.full_name=r),placeholder:"Enter full name"},null,8,["modelValue"])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Email",-1)),d(u(V),{modelValue:a.value.email,"onUpdate:modelValue":e[2]||(e[2]=r=>a.value.email=r),type:"email",disabled:"",class:"bg-gray-50"},null,8,["modelValue"]),e[22]||(e[22]=t("p",{class:"text-xs text-gray-500 mt-1"},"Email cannot be changed",-1))])]),t("div",xt,[d(u(C),{onClick:e[3]||(e[3]=r=>m.value=!1),variant:"outline"},{default:k(()=>[...e[23]||(e[23]=[_("Cancel",-1)])]),_:1}),d(u(C),{onClick:B,variant:"solid",loading:i.value},{default:k(()=>[...e[24]||(e[24]=[_("Save Changes",-1)])]),_:1},8,["loading"])])])])):L("",!0)]))}};export{kt as default};
